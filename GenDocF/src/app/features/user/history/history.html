<section class="public-container">
  <div class="public-panel public-reveal">
    <span class="public-kicker">Historique</span>
    <h1 class="public-title">Historique des documents</h1>
    <p class="public-subtitle">Gérez et téléchargez vos documents générés.</p>
    <div class="public-actions">
      <a routerLink="/user/document" class="public-btn public-btn--primary">
        Historique des documents
      </a>
    </div>
  </div>

  <section class="public-section">
    <div *ngIf="isLoading" class="public-panel public-reveal">
      <div class="public-card-text">Chargement de l'historique...</div>
    </div>

    <div *ngIf="errorMessage" class="public-panel public-reveal">
      <div class="public-card-text">{{ errorMessage }}</div>
    </div>

    <div *ngIf="!isLoading && !errorMessage" class="public-panel public-reveal">
      <table *ngIf="documents.length > 0; else emptyState" style="width: 100%; border-collapse: collapse;">
        <thead>
          <tr style="text-transform: uppercase; font-size: 0.75rem; color: var(--public-muted);">
            <th style="text-align: left; padding: 10px 0;">Document</th>
            <th style="text-align: left; padding: 10px 0;">Date</th>
            <th style="text-align: left; padding: 10px 0;">Format</th>
            <th style="text-align: left; padding: 10px 0;">Statut</th>
            <th style="text-align: right; padding: 10px 0;">Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let doc of documents" style="border-top: 1px solid var(--public-line);">
            <td style="padding: 12px 0; font-weight: 600;">{{ doc.template_nom }}</td>
            <td style="padding: 12px 0; color: var(--public-muted);">{{ doc.date_generation | date:'dd MMM yyyy' }}</td>
            <td style="padding: 12px 0; color: var(--public-muted);">{{ doc.format }}</td>
            <td style="padding: 12px 0; color: var(--public-muted);">{{ doc.status }}</td>
            <td style="padding: 12px 0; text-align: right;">
              <div style="display: inline-flex; gap: 8px;">
                <button [routerLink]="['/user/document-preview', doc.id]" class="public-btn public-btn--ghost">Voir</button>
                <button (click)="onDownload(doc)" class="public-btn public-btn--ghost">Telecharger</button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>

      <ng-template #emptyState>
        <div class="public-card-text">Aucun document dans votre historique.</div>
      </ng-template>
    </div>
  </section>
</section>