<section class="public-container">
  <div class="public-panel public-reveal">
    <span class="public-kicker">Historique</span>
    <h1 class="public-title">Historique des documents</h1>
    <p class="public-subtitle">Gérez et téléchargez vos documents générés.</p>
    <div class="public-actions">
      <a routerLink="/user/document" class="public-btn public-btn--primary">
        Historique des documents
      </a>
    </div>
  </div>

  <section class="public-section">
    <div *ngIf="isLoading" class="public-panel public-reveal">
      <div class="public-card-text">Chargement de l'historique...</div>
    </div>

    <div *ngIf="errorMessage" class="public-panel public-reveal">
      <div class="public-card-text">{{ errorMessage }}</div>
    </div>

    <div *ngIf="!isLoading && !errorMessage" class="public-panel public-reveal">
      <!-- Version Desktop/Tablet - Tableau -->
      <table *ngIf="documents.length > 0; else emptyState">
        <thead>
          <tr>
            <th>Document</th>
            <th>Date</th>
            <th>Format</th>
            <th>Statut</th>
            <th style="text-align: right;">Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let doc of documents">
            <td>{{ doc.template_nom }}</td>
            <td>{{ doc.date_generation | date:'dd MMM yyyy' }}</td>
            <td>{{ doc.format }}</td>
            <td>{{ doc.status }}</td>
            <td style="text-align: right;">
              <div class="table-actions">
                <button [routerLink]="['/user/document-preview', doc.id]" class="public-btn public-btn--ghost">Voir</button>
                <button (click)="onDownload(doc)" class="public-btn public-btn--ghost">Telecharger</button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>

      <!-- Version Mobile - Cards -->
      <div *ngIf="documents.length > 0" class="mobile-document-list">
        <div *ngFor="let doc of documents" class="mobile-document-card">
          <div class="mobile-document-header">
            <div class="mobile-document-title">{{ doc.template_nom }}</div>
            <span class="mobile-document-status">{{ doc.status }}</span>
          </div>
          
          <div class="mobile-document-info">
            <div class="mobile-document-info-item">
              <span class="mobile-document-info-label">Date:</span>
              <span>{{ doc.date_generation | date:'dd MMM yyyy' }}</span>
            </div>
            <div class="mobile-document-info-item">
              <span class="mobile-document-info-label">Format:</span>
              <span>{{ doc.format }}</span>
            </div>
          </div>
          
          <div class="mobile-document-actions">
            <button [routerLink]="['/user/document-preview', doc.id]" class="public-btn public-btn--ghost">Voir</button>
            <button (click)="onDownload(doc)" class="public-btn public-btn--ghost">Telecharger</button>
          </div>
        </div>
      </div>

      <ng-template #emptyState>
        <div class="public-card-text">Aucun document dans votre historique.</div>
      </ng-template>
    </div>
  </section>
</section>